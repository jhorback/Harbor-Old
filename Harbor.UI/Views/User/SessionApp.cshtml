@using Harbor.UI.Models.JSPM.Extensions
@model Harbor.UI.Models.User.CurrentUserDto
@Html.InstallJavaScriptPackage(Harbor.UI.JSPkgs.SessionAppPkg.PackageName)
<script>
	module("appui").register("baseUrl", window.baseUrl);

	// jch! playing...
	var menu =  @Html.Raw(Json.Encode(ViewBag.Menu));
	console.debug(menu);

	context.module("currentUserModel").register("currentUserDto", @Html.Raw(Json.Encode(Model)));
	Session.start();

	// jch! move this into the session app
	$(function () {
		var doc = $(document),
			body = $("body"),
			headBg = $("#frame-header-background"),
			setScrolled = _.throttle(function () {
				if (doc.scrollTop() > 0) {
					body.addClass("scrolled");
					headBg.css("opacity", 1);
				} else {
					headBg.css("opacity", .2);
					body.removeClass("scrolled");
				}
			}, 200);
		doc.on("scroll", setScrolled);
		setScrolled();
	});
</script>